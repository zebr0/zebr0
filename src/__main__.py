import argparseimport loggingimport sysimport configimport ec2import route53def setup_logs(stream, debug):  # TODO: extract into zebr0.log library ?    stream_handler = logging.StreamHandler(stream)    stream_handler.setFormatter(logging.Formatter("{asctime} | {levelname:<7.7} | {name:<25.25} | {message}", style="{"))    root_logger = logging.getLogger()    root_logger.setLevel(logging.DEBUG if debug else logging.INFO)    root_logger.addHandler(stream_handler)def init_environment(args):    setup_logs(sys.stdout, args.debug)    config_service = config.Service(args.project, args.stage)    ec2_service = ec2.Service(config_service)    vpc_id = ec2_service.create_vpc_if_needed()    subnet_id = ec2_service.create_subnet_if_needed(vpc_id)    ec2_service.create_internet_gateway_if_needed(vpc_id)    instance_id = ec2_service.create_instance_if_needed(subnet_id)    address = ec2_service.create_address_if_needed(instance_id)    route53_service = route53.Service(config_service)    route53_service.create_dns_entry_if_needed(address)def destroy_environment(args):    setup_logs(sys.stdout, args.debug)    config_service = config.Service(args.project, args.stage)    route53_service = route53.Service(config_service)    route53_service.destroy_dns_entry_if_needed()    ec2_service = ec2.Service(config_service)    ec2_service.destroy_address_if_needed()    ec2_service.destroy_instance_if_needed()    ec2_service.destroy_internet_gateway_if_needed()    ec2_service.destroy_subnet_if_needed()    ec2_service.destroy_vpc_if_needed()def edit_config(args):    config.edit_config(args.filename)if __name__ == "__main__":    argparser = argparse.ArgumentParser(description="")    subparsers = argparser.add_subparsers()    parser_init = subparsers.add_parser("init", help="")    parser_init.add_argument("project", help="")    parser_init.add_argument("stage", help="")    parser_init.add_argument("--debug", action="store_true", help="")    parser_init.set_defaults(func=init_environment)    parser_destroy = subparsers.add_parser("destroy", help="")    parser_destroy.add_argument("project", help="")    parser_destroy.add_argument("stage", help="")    parser_destroy.add_argument("--debug", action="store_true", help="")    parser_destroy.set_defaults(func=destroy_environment)    parser_config = subparsers.add_parser("config", help="")    parser_config.add_argument("filename", nargs="?", default=config.default_path, help="")    parser_config.set_defaults(func=edit_config)    args = argparser.parse_args()    args.func(args)